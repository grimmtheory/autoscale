[[local|localrc]]
HOST_IP=192.168.254.10
DEVSTACK_BRANCH=master
DEVSTACK_PASSWORD=stack


# Global Options
LOGFILE=/opt/stack/logs/stack.sh.log
VERBOSE=True
LOG_COLOR=False
SCREEN_LOGDIR=/opt/stack/logs
LOGDAYS=1
RECLONE=yes

# Speedup DevStack Install, hard set mirror
# UBUNTU_INST_HTTP_HOSTNAME="archive.ubuntu.com"
# UBUNTU_INST_HTTP_DIRECTORY="/ubuntu"

# Auth Info
ADMIN_PASSWORD=$DEVSTACK_PASSWORD
DATABASE_PASSWORD=$DEVSTACK_PASSWORD
RABBIT_PASSWORD=$DEVSTACK_PASSWORD
SERVICE_PASSWORD=$DEVSTACK_PASSWORD
SERVICE_TOKEN=$DEVSTACK_PASSWORD

# Branches
KEYSTONE_BRANCH=$DEVSTACK_BRANCH
NOVA_BRANCH=$DEVSTACK_BRANCH
NEUTRON_BRANCH=$DEVSTACK_BRANCH
SWIFT_BRANCH=$DEVSTACK_BRANCH
GLANCE_BRANCH=$DEVSTACK_BRANCH
CINDER_BRANCH=$DEVSTACK_BRANCH
HEAT_BRANCH=$DEVSTACK_BRANCH
TROVE_BRANCH=$DEVSTACK_BRANCH
HORIZON_BRANCH=$DEVSTACK_BRANCH
SAHARA_BRANCH=$DEVSTACK_BRANCH

## Disable unwanted services
# Nova network
disable_service n-net
# Tempest services
disable_service tempest
# Sahara
disable_service sahara
# Trove services
disable_service trove
disable_service tr-api
disable_service tr-mgr
disable_service tr-cond
# Swift services
disable_service s-proxy
disable_service s-object
disable_service s-container
disable_service s-account

# Enable Cinder services
# enable_service cinder
# enable_service c-api
# enable_service c-vol
# enable_service c-sch
# enable_service c-bak

# Enable Database Backend MySQL
enable_service mysql

# Enable RPC Backend RabbitMQ
enable_service rabbit

# Enable Keystone - OpenStack Identity Service
enable_service key

# Enable Horizon - OpenStack Dashboard Service
enable_service horizon

# Enable Glance - OpenStack Image Registry service 
enable_service g-api
enable_service g-reg

# Enable Ceilometer - Metering Service (metering + alarming)
enable_service ceilometer-acompute
enable_service ceilometer-acentral
enable_service ceilometer-anotification
enable_service ceilometer-api
enable_service ceilometer-alarm-notifier
enable_service ceilometer-alarm-evaluator

# Enable Heat - Orchestration Service
enable_service heat
enable_service h-api
enable_service h-api-cfn
enable_service h-api-cw
enable_service h-eng

# Images
IMAGE_URLS="http://cloud-images.ubuntu.com/releases/14.04/release/ubuntu-14.04-server-cloudimg-amd64-disk1.img,http://download.cirros-cloud.net/0.3.3/cirros-0.3.3-x86_64-disk.img"

# Enable Neutron - Networking Service
enable_service neutron
enable_service q-svc
enable_service q-agt
enable_service q-dhcp
enable_service q-l3
enable_service q-meta
enable_service q-lbaas
# enable_service q-fwaas
# enable_service q-metering
# enable_service q-vpn

# Neutron Options
# VLAN configuration.
PUBLIC_SUBNET_NAME="public"
PRIVATE_SUBNET_NAME="private"

# PUBLIC_INTERFACE=eth2
# OVS_PHYSICAL_BRIDGE=br-ex

Q_PLUGIN=ml2
Q_AGENT=linuxbridge
Q_USE_PROVIDERNET_FOR_PUBLIC=True
PUBLIC_PHYSICAL_NETWORK=flat_net1

[[post-config|/$Q_PLUGIN_CONF_FILE]]
[ml2]
tenant_network_types = vlan
type_drivers = local,flat,vlan,vxlan
mechanism_drivers = linuxbridge,l2population

[vxlan]
# warning: there are usually mtu issues with vxlan
enable_vxlan = True
local_ip = $HOST_IP
l2_population = True

[ml2_type_vxlan]
vni_ranges = 1001:2000

[ml2_type_vlan]
network_vlan_ranges = vlan_net1:1000:1999

[ml2_type_flat]
flat_networks = flat_net1

[linux_bridge]
# in virtualbox these nics need promiscous mode enabled
physical_interface_mappings = vlan_net1:eth1,flat_net1:eth2

[securitygroup]
firewall_driver = neutron.agent.linux.iptables_firewall.IptablesFirewallDriver
#firewall_driver = neutron.agent.firewall.NoopFirewallDriver
enable_security_group = True


[[post-config|$NEUTRON_CONF]]
[DEFAULT]
default_log_levels=amqp=WARN,amqplib=WARN,boto=WARN,qpid=WARN,sqlalchemy=WARN,suds=INFO,oslo.messaging=INFO,iso8601=WARN,requests.packages.urllib3.connectionpool=WARN,urllib3.connectionpool=WARN,websocket=WARN,keystonemiddleware=WARN,routes.middleware=WARN,stevedore=WARN,neutron.context=WARN

# Q_ML2_PLUGIN_MECHANISM_DRIVERS=openvswitch
# Q_ML2_TENANT_NETWORK_TYPE=vlan

# PHYSICAL_NETWORK=physnet1
# OVS_PHYSICAL_BRIDGE=br-eth1
# OVS_BRIDGE_MAPPINGS=physnet1:br-eth1

# OVS_ENABLE_TUNNELING=False
# ENABLE_TENANT_VLANS=True
# TENANT_VLAN_RANGE=500:2000

# GUEST_INTERFACE_DEFAULT=eth1
# PUBLIC_INTERFACE_DEFAULT=eth2

FIXED_RANGE=10.0.254.128/25
NETWORK_GATEWAY=10.0.254.129

FLOATING_RANGE=192.168.254.128/25
PUBLIC_NETWORK_GATEWAY=192.168.254.129

# ENABLE_TENANT_VLANS=True
# TENANT_VLAN_RANGE=3001:4000

# Q_PLUGIN=ml2
# Q_USE_SECGROUP=False
# Q_L3_ENABLED=True

# PROVIDER_SUBNET_NAME="provider_net"
# PROVIDER_NETWORK_TYPE="vlan"
# Q_USE_PROVIDER_NETWORKING=True
# SEGMENTATION_ID=2010

# GRE tunnel configuration
# Q_PLUGIN=ml2
# ENABLE_TENANT_TUNNELS=True

# VXLAN tunnel configuration
# Q_PLUGIN=ml2
# Q_ML2_TENANT_NETWORK_TYPE=vxlan

